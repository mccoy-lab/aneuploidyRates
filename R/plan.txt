Goal: 
	Predict meiotic and mitotic error rates of aneuploidy embryos


Steps:
	- Convert probability of being affected to proportion of aneuploid cells
	- Make embryos based on the proportion of aneuploid cells. Embryos can be fully aneuploid, partially aneuploid, and euploid
	- Take one biopsy from each embryo
	- Collect the result into one dataframe (?combine with the step above?)
	- Run multiple dataframes through EasyABC for comparison and return the closest parameters.


Files (1 function per file)

1. prob_to_prop (?)
	Inputs: 
		probability of being affected by meiotic errors, 
		probability of being affected by mitotic errors,
		number of cell divisions
	Output:
		proportion of total affected (aneuploid) cells
	Notes:
		- Default 8 divisions
		- prop.aneu = proportion of aneuploid CELLS in an embryo.
		- First check for meiotic errors. If true, then return prop.aneu = 1
		- Then check for mitotic errors. Do calculations for each division.
	Questions:


2. create_embryo
	Inputs:
		prop.aneu,
		number of cells,
		number of chromosomes,
		dispersal = 0,
		concordance= 0
	Outputs:
		an embryo object
	Notes:
		- Borrow code from Tessera for embryo creation
		- Keep concordance and dispersal at 0
	Questions:
		solved=1. Make 1 embryo in the function? Or ALL embryos together?
		
		
3. take_biopsy
	Inputs:
		the embryo,
		biopsy size,
	Outputs:
		a type (represented by ints): euploid, mosaic, aneuploid
	Notes:
		- Tessera code
	Questions:
		1. Do biopsy for 1 embryo or ALL embryos?

4. summarize_biopsies (needed if file 2 and 3 are for single results)
	Inputs: (wrapper function?)
		number of embryos, two probabilities
	Outputs:
		an organized dataframe summary with headers like this:
	prob.meio	prob.mito	#euploid	#mosaic		#aneuploid
	
	Notes:
		- Need to call multiple create_embryo and take biopsy (?)
		- Need to convert the biopsy integers to corresponding types
		- Can convert the number of types to percentages
	Questions:
		1. This file requires multiple data, so where to insert the number of embryos between file 3 and 4?
		2. Should the two probabilities be included as inputs or randomly selected data from a range?

5. find_rates
	Inputs:
		the range for probabilities,
		the reference data,
		number of trials to run through EasyABC_rej
	Outputs:
		the best rate of meiotic error,
		the best rate of mitotic error
	Notes:
		- Use Easy_ABC to select
		- Input methods from all above?
	Questions:
		1. Include a graph in output, or different function?
		2. Pick the selective range of results?

6. plot_result
	Outputs:
		a figure (heat-map?) with axes: prob.meio and prob.mito 
